<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ecoplantia AR Garden - Spatial Test</title>
  
  <!-- Google's model-viewer component -->
  <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1B5E20, #4CAF50);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    
    h1 {
      color: white;
      font-size: 24px;
      margin-bottom: 10px;
      text-align: center;
    }
    
    p {
      color: rgba(255,255,255,0.9);
      font-size: 14px;
      text-align: center;
      margin-bottom: 20px;
      max-width: 300px;
    }
    
    .viewer-container {
      width: 100%;
      max-width: 400px;
      height: 400px;
      background: white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      margin-bottom: 20px;
    }
    
    model-viewer {
      width: 100%;
      height: 100%;
      --poster-color: transparent;
    }
    
    model-viewer::part(default-ar-button) {
      background: #4CAF50;
      border-radius: 25px;
      padding: 12px 24px;
      font-weight: 600;
    }
    
    .ar-button {
      background: white;
      color: #1B5E20;
      border: none;
      padding: 16px 40px;
      border-radius: 30px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .ar-button:active {
      transform: scale(0.98);
    }
    
    .info {
      background: rgba(255,255,255,0.15);
      padding: 15px 20px;
      border-radius: 12px;
      color: white;
      font-size: 12px;
      max-width: 350px;
      margin-top: 20px;
    }
    
    .info h3 {
      font-size: 14px;
      margin-bottom: 8px;
    }
    
    .info ul {
      margin-left: 20px;
    }
    
    /* Custom AR prompt for scanning floor */
    .ar-prompt {
      position: absolute;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      font-size: 14px;
      display: none;
    }
    
    model-viewer[ar-status="session-started"] .ar-prompt {
      display: block;
    }
    
    /* Hide when placed */
    model-viewer[ar-tracking="tracking"] .ar-prompt {
      display: none;
    }
  </style>
</head>
<body>
  <h1>ðŸŒ¿ Ecoplantia AR Test</h1>
  <p>View your garden in real-world AR! This works on both iPhone and Android.</p>
  
  <div class="viewer-container">
    <!-- 
      This uses a demo GLB for now. 
      For Ecoplantia, we'd generate a GLB with your plant PNGs as billboard textures.
      model-viewer auto-converts to USDZ for iOS Quick Look!
    -->
    <model-viewer
      id="gardenViewer"
      src="https://modelviewer.dev/shared-assets/models/Astronaut.glb"
      ar
      ar-modes="webxr scene-viewer quick-look"
      camera-controls
      touch-action="pan-y"
      auto-rotate
      shadow-intensity="1"
      environment-image="neutral"
      alt="Ecoplantia Garden AR Preview"
    >
      <button slot="ar-button" class="ar-button">
        ðŸ“± View in AR
      </button>
      
      <div class="ar-prompt">
        <span>ðŸ‘† Move phone to find a surface</span>
      </div>
    </model-viewer>
  </div>
  
  <div class="info">
    <h3>How this works:</h3>
    <ul>
      <li><strong>iPhone/iPad:</strong> Opens in Quick Look (walk around!)</li>
      <li><strong>Android:</strong> Opens in Scene Viewer or WebXR</li>
      <li>Your plants become 3D billboards</li>
      <li>Place the garden, then walk around it!</li>
    </ul>
  </div>
  
  <div class="info" style="margin-top: 15px;">
    <h3>Next Steps for Ecoplantia:</h3>
    <ul>
      <li>Generate GLB with plant PNG textures</li>
      <li>Position plants in 3D space (like mockup)</li>
      <li>model-viewer handles iOS/Android automatically</li>
      <li>Deploy to Vercel, link from Wix designer</li>
    </ul>
  </div>

  <script>
    const viewer = document.getElementById('gardenViewer');
    
    // Log AR status changes
    viewer.addEventListener('ar-status', (e) => {
      console.log('AR Status:', e.detail.status);
    });
    
    // Log when AR tracking starts
    viewer.addEventListener('ar-tracking', (e) => {
      console.log('AR Tracking:', e.detail.status);
    });
    
    /*
    NEXT: To use your actual plant PNGs, we need to:
    
    1. Create a GLB file with flat planes for each plant
    2. Apply PNG textures to each plane
    3. Position them in 3D space (x, y, z)
    4. Export as single .glb file
    
    This can be done:
    - Server-side with Three.js (Vercel API route)
    - Pre-generated for common garden layouts
    - Or dynamically with Three.js USDZExporter
    
    The model-viewer component handles:
    - iOS: Auto-converts GLB â†’ USDZ â†’ Quick Look
    - Android: Scene Viewer or WebXR
    - Desktop: 3D preview with mouse controls
    */
  </script>
</body>
</html>
